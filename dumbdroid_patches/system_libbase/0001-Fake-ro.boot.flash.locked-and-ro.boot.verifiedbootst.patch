From 74a27113c103f0167be0c6cd918f195bee0c909e Mon Sep 17 00:00:00 2001
From: Michal Brzozowski <miki@extremic.com>
Date: Wed, 9 Jul 2025 12:47:05 +0200
Subject: [PATCH] Fake ro.boot.flash.locked and ro.boot.verifiedbootstate to
 state that the bootloader is locked

Change-Id: Idfcf6d05f33c8b816f6e11e7bdd5b3fa2604c763
---
 properties.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/properties.cpp b/properties.cpp
index a20db54..0b6933a 100644
--- a/properties.cpp
+++ b/properties.cpp
@@ -108,6 +108,10 @@ template uint64_t GetUintProperty(const std::string&, uint64_t, uint64_t);
 
 std::string GetProperty(const std::string& key, const std::string& default_value) {
   std::string property_value;
+  if (key == "ro.boot.flash.locked")
+	  return "1";
+  if (key == "ro.boot.verifiedbootstate")
+	  return "green";
 #if defined(__BIONIC__)
   const prop_info* pi = __system_property_find(key.c_str());
   if (pi == nullptr) return default_value;
-- 
2.34.1

